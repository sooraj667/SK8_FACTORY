{% extends 'store/userdashboard/loggedin.html' %}
{% load static %}

{% block content %}
<div class="row mt-5"></div>
<div class="row mt-5"></div>
<div class="row mt-5"></div>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="card">
				<div class="card-header flex-c-m p-lr-10 trans-04 signupdesign">
					<h4>Add Address</h4>
				</div>
				<div class="card-body">
					<form method="POST"> {% csrf_token %}
						<div class="form-group">
							<label for="email">Country</label>
							<input type="text" value="{{country}}" class="form-control" id="email" placeholder="Enter Username" name="country" Required>
							{% if error and "country" in error %}
							<span style="color: red">{{error.country}}</span>
							{% endif %}
						</div>
						<div class="form-group">
							<label for="email">State</label>
							<input type="text" value="{{state}}" class="form-control" id="email" placeholder="Enter Name" name="state" Required>
							{% if error and "state" in error %}
							<span style="color: red">{{error.state}}</span>
							{% endif %}
	
						<div class="form-group">
							<label for="email">District</label>
							<input type="text" value="{{district}}" class="form-control" id="email" placeholder="Enter email" name="district" Required>
							{% if error and "district" in error %}
							<span style="color: red">{{error.district}}</span>
							{% endif %}
						</div>
						<div class="form-group">
							<label for="email">Locality</label>
							<input type="text" value="{{locality}}" class="form-control" id="email" placeholder="Enter contact number" name="locality" Required>
							{% if error and "locality" in error %}
							<span style="color: red">{{error.locality}}</span>
							{% endif %}
						</div>
						<div class="form-group">
							<label for="password">House</label>
							<input type="text" value="{{house}}" class="form-control" id="password" placeholder="Enter Password" name="house" Required>
							{% if error and "house" in error %}
							<span style="color: red">{{error.house}}</span>
							{% endif %}
						</div>
						<div class="form-group">
							<label for="password">Pincode</label>
							<input type="number" value="{{pincode}}" class="form-control" id="password" placeholder="Re- enter Password" name="pincode" Required>
							{% if error and "pincode" in error %}
							<span style="color: red">{{error.pincode}}</span>
							{% endif %}
						</div>
						<div class="justify-content-center ">
							<button type="submit" class="flex-c-m stext-101 cl5 size-103 bg2 bor1 hov-btn1 p-lr-15 trans-04 ">Submit</button>

						</div>
						<div>
							{% if messages %}
								{% for message in messages %}
									<div class="alert alert-success" role="alert">
										{{ message }}
									</div>
								{% endfor %}
							{% endif %}
						</div>
						
						<div >
							<h5 class=" text-success mt-3">
								{{context}} 
							</h5>
						  
						</div>
						

					</form>
				
				</div>
			</div>
			<label for="dropdown">Select an option:</label>

			{% comment %} <select name="orderstatus" class="form-control" id="orderstatus">
				<option value="Ordered" {% if item.orderstatus == "Ordered" %}selected{% endif %}>Ordered</option>
				<option value="Cancelled" {% if item.orderstatus == "Cancelled" %}selected{% endif %}>Cancelled</option>
				<option value="Shipped" {% if item.orderstatus == "Shipped" %}selected{% endif %}>Shipped</option>
			</select> {% endcomment %}

			{% comment %} <select id="dropdown" name="address">
				{% for item in addressobjs  %}
				<option value="{{item.house}}">{{item.country}} <br>{{item.state}}<br>{{item.house}} </option>
				{% endfor %}
	
			</select>  {% endcomment %}

			{% comment %} <select id="dropdown">
			{% for item in addressobjs  %}
			<option value="option1">{{item.country}} <br>{{item.state}}<br>{{item.house}} </option>
			{% endfor %}

			</select> {% endcomment %}

        </div>


		



    </div>
	<div class="col-md-6">
		<div class="ml-5">
			<span class="block1-name ltext-102 trans-04 p-b-8">
				Your Order
			</span>
			<br><br><br>

			<table class="table table-borderless">
				<thead>
					<tr>
						<th>Item</th>
						<th>Quantity </th>
						<th>Amount </th>
					</tr>
				</thead>
				<tbody>
					{% for item in cartobjs  %}
					<tr>
						<td>{{item.product.name}}</td>
						<td>{{item.quantity}}</td>
						<td>{{item.total}}</td>
					</tr>
					{% endfor %}
					
				</tbody>
			</table>


			{% comment %} {% for item in cartobjs  %}

			<td>{{item.product.name}} X {{item.quantity}} - {{item.total}}</td><br>



			{% endfor %} {% endcomment %}
			<br><br>
			<div class="row">
				<div class="col-md-4">
					<span class="block1-name ltext-102 trans-04 p-b-8">
						Cart Total 
					</span>
	
				</div>
				<div class="col-md-8">
					<span class="font-weight-bold display-4">{{totalsum}}</span>
	
				</div>

			</div>

			<form method="POST" action="{% url 'cashondelivery' %}">
				{% csrf_token %}
				<select id="dropdown" name="address">
					{% for item in addressobjs  %}
					<option value="{{item.house}}">{{item.country}} <br>{{item.state}}<br>{{item.house}} </option>
					{% endfor %}
		
				</select> 

				<button type="submit" class="btn btn-primary">Cash On Delivery</button>
				



			</form>
			{% comment %} <a href=>
				<button type="button" class="btn btn-primary">Cash On Delivery</button>

			</a> {% endcomment %}

			<button type="submit" class="btn-success" id="rzp-button1">Pay with Razorpay</button>
			
			
			


		</div>
	
		

	</div>
</div>



















{% endblock content %}




{% block script %}

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
	"key": "{{api_key}}", // Enter the Key ID generated from the Dashboard
	"amount": "{{amount}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
	//"currency": "INR",
	"name": "SK8 FACTORY ",
	"description": "Test Transaction",
	//"image": "https://example.com/your_logo",
	"order_id": "{{order_id}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
	"handler": function (response){
		alert(response.razorpay_payment_id);
		alert(response.razorpay_order_id);
		alert(response.razorpay_signature)
	},
	"prefill": {
	"name": "Gaurav Kumar",
	"email": "gaurav.kumar@example.com",
	"contact": "9000090000"
	},
	"notes": {
	  "address": "Razorpay Corporate Office"
	},
	"theme": {
		"color": "#3399cc"
	}
};
var rzp1 = new Razorpay(options);
rzp1.on('payment.failed', function (response){
		//alert(response.error.code);
		alert(response.error.description);
		//alert(response.error.source);
		//alert(response.error.step);
		//alert(response.error.reason);
		//alert(response.error.metadata.order_id);
		//alert(response.error.metadata.payment_id);
});
document.getElementById('rzp-button1').onclick = function(e){
	rzp1.open();
	e.preventDefault();
}
</script>
	
{% endblock script %}


